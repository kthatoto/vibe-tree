# 指示: Design Tree を「タスク戦略ツール」に作り直せ

## 背景
- いま最低限のチャット（Claudeとの会話）は動いている
- しかし design branch / design tree が意味不明で、実用になっていない
- やりたいのは「ブランチ設計」ではなく **タスク分解 + 依存関係 + 開発戦略ツリー**

## やりたいこと（結論）
1. Design Tree を「タスクツリー」として再定義する
2. 会話で出たタスクを候補として溜める
3. UIでドラッグ操作して親子関係（依存）を組めるようにする
4. 確定したツリーをもとに開発を進められるようにする

## 具体指示

### 1. Design Tree の意味を変えろ
- design tree = 「どういうタスク順・ブランチ戦略で進めるかの設計図」
- Gitに存在しない仮想ノードでOK
- divergence警告は「設計ツリー vs 実際のGit構造」の比較として残す

### 2. データ構造をタスク寄りに修正
tree_specs の node に最低限これを持たせる:
- id
- title（タスク名）
- description（完了条件/メモ）
- status（todo / doing / done）
- branchName（未確定ならnull）
- baseBranch（親ノードから継承でOK）

### 3. UIをこう作れ（MVP）
- 左ペイン: タスク候補リスト
  - 会話から「タスク化」されたものが並ぶ
- 右ペイン: ツリーキャンバス
  - ドラッグ&ドロップでノード配置
  - ドラッグで親子関係を変更できる
- 保存で tree_specs を更新

### 4. 「ベースブランチ」問題を即修正
- main/master 決め打ちはやめる
- ベースブランチはこの優先順で決める:
  1) originのHEAD（git symbolic-ref / gh repo view）
  2) scan結果にあるブランチ一覧
     - develop があれば develop
     - なければ main → master
- UIのセレクトボックスは scan結果の branches から動的生成する

### 5. 開発につなげる導線
- ツリー確定後:
  - 各ノードに対してブランチ名を自動生成
  - 「このタスクを開始」ボタンで
    - ブランチ作成
    - worktree作成（or コマンド生成）
    - そのworktree用チャットセッションを自動で紐付け

## まずやる順番
1. ベースブランチ決め打ち(main固定)を撤廃
2. design tree を「タスクツリー」として扱うよう修正
3. ドラッグで親子を組めるUIを作る（見た目より機能優先）
4. 確定 → 開発開始の導線を作る

## ゴール
- 「何をどの順でやるか」がツリーで見える
- developしかないrepoでも正しく戦略を立てられる
- design tree が“飾り”ではなく、実際の開発の起点になる
